<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudBoard</title>
    <link rel="stylesheet" type="text/css" href="static/css/default.css" />
    <link rel="stylesheet" type="text/css" href="static/css/projektdetails.css" />
</head>

<body>
    <header class="header">
        <picture class="header__logo">
            <source media="(min-width: 1920px)" srcset="images\header1920x200.png" type="image/png">
            <source media="(min-width: 1280px)" srcset="images\header1280x133.png" type="image/png">
            <source media="(min-width: 640px)" srcset="images\header640x67.png" type="image/png">
            <img src="images\header320x34.png" alt="StudBoard Logo">
        </picture>
        <div class="header-infos">
            <a href="index.html">
                <svg class="header-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" />
                </svg>
            </a>
            <a href="projekte.html" class="header-link">Projekte</a>
            <a href="neuesprojekt.html" class="header-link">Neues Projekt</a>
            <div class="header-login">
                <input type="text" placeholder="Benutzername" class="header-login__input" id="user-name-input">
                <button class="header-login__button" id="login-button">Login</button>
                <input type="password" placeholder="Passwort" class="header-login__input" id="password-input">
                <button class="header-login__button" id="register-button">Registrieren</button>
            </div>
        </div>
    </header>
    <main class="main">
        <div class="main_overview">
            <ul class="project_overview">
                <li class="overview_project_name">
                    <a href="#titel">
                        <p class="project_name">Titel</p>
                    </a>
                </li>
                <li class="overview_project_name">
                    <a href="#kurzbeschreibung">
                        <p class="project_name">Kurzbeschreibung</p>
                    </a>
                </li>
                <li class="overview_project_name">
                    <a href="#beschreibung">
                        <p class="project_name">Beschreibung</p>
                    </a>
                </li>
                <li class="overview_project_name">
                    <a href="#ziele">
                        <p class="project_name">Ziele</p>
                    </a>
                </li>
                <li class="overview_project_name">
                    <a href="#comment">
                        <p class="project_name">Kommentar</p>
                    </a>
                </li>
            </ul>
        </div>
        <div class="main_details">
            <img class="logo" src="images/projects/1.png" alt="Project Logo">
            <h1 class="main__title" id="titel">Projekt Titel</h1>
            <p class="author">von Niklas Schumann</p>
            <div class="main__content">
                <h3 class="main__content__title" id="kurzbeschreibung">Kurzbeschreibung</h3>
                <p class="main__content__text" id="kurzbeschreibung-content">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Molestias laboriosam voluptate dolorem minima delectus eligendi exercitationem explicabo expedita.
                    Incidunt quis quibusdam maxime, ipsa modi quam in ratione optio distinctio repudiandae?</p>
                <h3 class="main__content__title" id="beschreibung">Beschreibung</h3>
                <p class="main__content__text" id="beschreibung-content">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Molestias laboriosam voluptate dolorem minima delectus eligendi exercitationem explicabo expedita.
                    Incidunt quis quibusdam maxime, ipsa modi quam in ratione optio distinctio repudiandae?
                    Lorem ipsum dolor sit amet consectetur adipisicing elit.
                    Molestias laboriosam voluptate dolorem minima delectus eligendi exercitationem explicabo expedita.
                    Incidunt quis quibusdam maxime, ipsa modi quam in ratione optio distinctio repudiandae?
                    Lorem ipsum dolor sit amet consectetur adipisicing elit.
                </p>
                <h3 class="main__content__title" id="ziele">Ziele</h3>
                <ol class="main__content__list" id="ziele-content">
                    <li class="main__content__list__item">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                        Molestias laboriosam voluptate dolorem minima delectus eligendi exercitationem explicabo
                        expedita.
                        Incidunt quis quibusdam maxime, ipsa modi quam in ratione optio distinctio repudiandae?</li>
                    <li class="main__content__list__item">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                        Molestias laboriosam voluptate dolorem minima delectus eligendi exercitationem explicabo
                        expedita.
                        Incidunt quis quibusdam maxime, ipsa modi quam in ratione optio distinctio repudiandae?</li>
                </ol>
            </div>
            <form class="comment_form" action="rating.html" method="get">
                <h3 class="main__content__title">Kommentar</h3>
                <textarea class="comment_form__textarea" name="comment" id="comment" cols="30" rows="3"
                    required placeholder="Kommentar..."
                    style="max-width: 500px; "></textarea>
                <label>Rating:
                    <select class="comment_rating" id="rating" name="rating">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                </label>
                <button class="comment_form__button" type="submit">Kommentar absenden</button>
            </form>
        </div>
    </main>
    <footer class="footer">
        <div class="footer__content">
            <div class="footer__content__inner">
                <a href="./impressum.html">
                    <h3 class="footer__content__inner__title">Impressum</h3>
                </a>
                <a href="./datenschutz.html">
                    <h3 class="footer__content__inner__title">Datenschutz</h3>
                </a>
                <a href="./haftungsausschluss.html">
                    <h3 class="footer__content__inner__title">Haftungsausschluss</h3>
                </a>
                <a href="./kontakt.html">
                    <h3 class="footer__content__inner__title">Kontakt</h3>
                </a>
                <p class="footer__content__inner__copyright">Â© 2022 StudBoard</p>
            </div>
            <div class="back-to-top">
                <button class="back-to-top__btn" onclick="location.href='#top'">
                    <svg class="back-to-top__btn__icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                        viewBox="0 0 24 24">
                        <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" />
                        <path d="M0 0h24v24H0z" fill="none" />
                    </svg>
                </button>
            </div>
        </div>
    </footer>
</body>
<script>
    const url = new URL(window.location.href);
    const id = url.searchParams.get("id");
    // Check if query has id, if not return to previous page
    if (id == null || id === "" || Number.isNaN(id)) {
        window.history.go(-1)
    }

    const loginBtn = document.getElementById('login-button');
    const registerBtn = document.getElementById('register-button');
    const userNameInput = document.getElementById('user-name-input');
    const passwordInput = document.getElementById('password-input');
    // If pressed on login button
    loginBtn.addEventListener('click', function () {
        const userName = userNameInput.value;
        const password = passwordInput.value;
        const xhr = new XMLHttpRequest();
        if (userName.trim() === '' || password.trim() === '') {
            alert('Please enter your user name and password');
            return;
        }
        xhr.open('POST', 'api/login');
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({
            userName: userName,
            password: password
        }));

        xhr.onload = function () {
            if (xhr.status === 200) {
                const response = JSON.parse(xhr.responseText);
                if (response.success) {
                    // set session
                    sessionStorage.setItem('userName', userName);
                } else {
                    alert(response.message);
                }
            } else {
                alert('Request failed.  Returned status of ' + xhr.status);
            }
        };
    });

    // If pressed on register button
    registerBtn.addEventListener('click', function () {
        const userName = userNameInput.value;
        const password = passwordInput.value;
        const xhr = new XMLHttpRequest();
        if (userName.trim() === '' || password.trim() === '') {
            alert('Please enter your user name and password');
            return;
        }
        xhr.open('POST', 'api/register');
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({
            userName: userName,
            password: password
        }));

        xhr.onload = function () {
            if (xhr.status === 200) {
                const response = JSON.parse(xhr.responseText);
                if (response.success) {
                    // set session
                    sessionStorage.setItem('userName', userName);
                } else {
                    alert(response.message);
                }
            } else {
                alert('Request failed.  Returned status of ' + xhr.status);
            }
        };
    });

    function setTitle(title) {
        document.getElementById('titel').innerHTML = title;
    }

    function setKurzbeschreibung(kurzbeschreibung) {
        document.getElementById('kurzbeschreibung-content').innerHTML = kurzbeschreibung;
    }

    function setBeschreibung(beschreibung) {
        document.getElementById('beschreibung-content').innerHTML = beschreibung;
    }

    function addZiel(ziel) {
        const zieleListe = document.getElementById('ziele-content');
        const li = document.createElement('li');
        li.innerHTML = ziel;
        zieleListe.appendChild(li);
    }

    function clearZiele() {
        const zieleListe = document.getElementById('ziele-content');
        zieleListe.innerHTML = '';
    }

    // Just for demonstration
    if (Number(id) === 1) {
        clearZiele();
        setTitle('Titel 1');
        setKurzbeschreibung('Kurzbeschreibung 1');
        setBeschreibung('Beschreibung 1');
        addZiel('Ziel 1');
        addZiel('Ziel 2');
    } else if (Number(id) === 2) {
        clearZiele();
        setTitle('Titel 2');
        setKurzbeschreibung('Kurzbeschreibung 2');
        setBeschreibung('Beschreibung 2');
        addZiel('Ziel 3');
    }
</script>

</html>